# 参数显示优化说明

## 优化背景

在优化任务列表和回测分析界面中，当参数很多时（如极大极小值策略有15个参数），参数显示会变得非常拥挤和丑陋，影响用户体验。

## 优化方案

### 1. 参数数量限制
- **表格显示**: 最多显示3个关键参数
- **详情显示**: 显示所有参数，但添加滚动容器
- **卡片显示**: 最多显示3个参数，其余用"+N个"表示

### 2. 参数名称简化
将英文参数名转换为中文简称，提高可读性：

| 英文参数名 | 中文简称 | 说明 |
|-----------|---------|------|
| `short_window` | 短期 | 短期均线周期 |
| `long_window` | 长期 | 长期均线周期 |
| `min_reversal_points` | 反转点 | 最小反转点数 |
| `lookback_period` | 回望期 | 回望周期 |
| `signal_strength_threshold` | 信号阈值 | 信号强度阈值 |
| `batch_count` | 批次数 | 分批建仓次数 |
| `stop_loss_ratio` | 止损 | 止损比例 |
| `take_profit_ratio` | 止盈 | 止盈比例 |
| `rsi_oversold` | RSI超卖 | RSI超卖阈值 |
| `rsi_overbought` | RSI超买 | RSI超买阈值 |
| `volume_threshold` | 成交量阈值 | 成交量放大阈值 |
| `max_extremums` | 最大极值点 | 最大极值点数量 |
| `min_extremum_distance` | 极值点距离 | 极值点最小距离 |

### 3. 样式优化

#### 表格中的参数显示
```typescript
// 最多显示3个参数，其余用"+N个"表示
const maxDisplay = 3;
const displayParams = paramEntries.slice(0, maxDisplay);
const remainingCount = paramEntries.length - maxDisplay;

// 紧凑的标签样式
style={{ 
  marginBottom: '2px', 
  fontSize: '10px',
  padding: '1px 4px',
  lineHeight: '16px'
}}
```

#### 详情页面的参数显示
```typescript
// 添加滚动容器，显示所有参数
<div style={{ maxHeight: '120px', overflowY: 'auto' }}>
  {/* 所有参数标签 */}
</div>
```

#### 卡片中的参数显示
```typescript
// 限制高度，防止卡片过高
<div style={{ maxHeight: '40px', overflow: 'hidden' }}>
  {/* 最多3个参数 + 剩余数量提示 */}
</div>
```

### 4. 数值格式化
- 浮点数保留1-2位小数
- 整数直接显示
- 统一数值格式

## 优化效果

### 优化前
- 参数过多时显示拥挤
- 英文参数名难以理解
- 表格行高不一致
- 信息密度过高

### 优化后
- ✅ **简洁美观**: 只显示关键参数
- ✅ **中文友好**: 参数名转换为中文
- ✅ **空间合理**: 限制显示高度
- ✅ **信息完整**: 用"+N个"提示剩余参数
- ✅ **滚动支持**: 详情页支持查看所有参数

## 具体实现

### 1. 优化任务列表表格
```typescript
{
  title: '最佳参数',
  dataIndex: 'best_parameters',
  key: 'best_parameters',
  width: 200,
  render: (params: Record<string, any>) => {
    if (!params) return '-';
    
    const paramEntries = Object.entries(params);
    const maxDisplay = 3; // 最多显示3个参数
    const displayParams = paramEntries.slice(0, maxDisplay);
    const remainingCount = paramEntries.length - maxDisplay;
    
    return (
      <div style={{ maxHeight: '60px', overflow: 'hidden' }}>
        {displayParams.map(([key, value]) => (
          <Tag key={key} color="blue" style={{ /* 紧凑样式 */ }}>
            {getParameterDisplayName(key)}: {formatValue(value)}
          </Tag>
        ))}
        {remainingCount > 0 && (
          <Tag color="default" style={{ /* 样式 */ }}>
            +{remainingCount}个
          </Tag>
        )}
      </div>
    );
  }
}
```

### 2. 任务详情页面
```typescript
{selectedJob.best_parameters && (
  <div style={{ marginTop: '16px' }}>
    <Text strong>最优参数组合:</Text>
    <div style={{ marginTop: '8px', maxHeight: '120px', overflowY: 'auto' }}>
      {Object.entries(selectedJob.best_parameters).map(([key, value]) => (
        <Tag key={key} color="blue" style={{ /* 样式 */ }}>
          {getParameterDisplayName(key)}: {formatValue(value)}
        </Tag>
      ))}
    </div>
  </div>
)}
```

### 3. 回测分析导入界面
```typescript
<div style={{ marginTop: 4, maxHeight: '40px', overflow: 'hidden' }}>
  {Object.entries(result.best_parameters || {}).slice(0, 3).map(([key, value]) => (
    <Tag key={key} style={{ /* 紧凑样式 */ }}>
      {getParameterDisplayName(key)}: {formatValue(value)}
    </Tag>
  ))}
  {Object.keys(result.best_parameters || {}).length > 3 && (
    <Tag style={{ /* 样式 */ }}>
      +{Object.keys(result.best_parameters || {}).length - 3}个
    </Tag>
  )}
</div>
```

## 参数名称映射函数

```typescript
const getParameterDisplayName = (key: string): string => {
  const nameMap: Record<string, string> = {
    'short_window': '短期',
    'long_window': '长期',
    'min_reversal_points': '反转点',
    'lookback_period': '回望期',
    'signal_strength_threshold': '信号阈值',
    'batch_count': '批次数',
    'stop_loss_ratio': '止损',
    'take_profit_ratio': '止盈',
    'rsi_oversold': 'RSI超卖',
    'rsi_overbought': 'RSI超买',
    'volume_threshold': '成交量阈值',
    'max_extremums': '最大极值点',
    'min_extremum_distance': '极值点距离'
  };
  return nameMap[key] || key;
};

const formatValue = (value: any): string => {
  if (typeof value === 'number') {
    return value.toFixed(2);
  }
  return String(value);
};
```

## 总结

通过这次优化，参数显示变得更加：

✅ **简洁美观**: 只显示关键参数，避免信息过载
✅ **中文友好**: 参数名转换为易懂的中文
✅ **空间合理**: 限制显示高度，保持界面整洁
✅ **信息完整**: 用"+N个"提示剩余参数数量
✅ **交互友好**: 详情页支持滚动查看所有参数

现在即使是有15个参数的极大极小值策略，在表格中也只显示3个关键参数，界面更加整洁美观！
